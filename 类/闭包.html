<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
</head>
<body>
    <ul class="test">
        <li>hello</li>
        <li>world</li>
        <li>love</li>
        <li>you</li>
    </ul>
    <!-- 
        闭包: 指有权访问另一个函数作用域中变量的函数。
        首先，闭包也是一个函数。
     -->
    <script>
        //fn就是一个闭包函数。
        function fn() {
            var num = 10;
            function fun() {
                console.log(num);
            }
            fun();  
        }
        fn();

        //闭包的作用：延伸了变量的作用范围。
        //f()函数也可以使用num变量了！
        function Fun() {
            var num = 20;
            return function() {
                console.log(num);
            }
        }
        var f = Fun();
        f();

        //
        var lis = document.querySelector('.test').querySelectorAll('li');
        for(var i = 0 ; i < lis.length; i++) {
            (function(i) {
                setTimeout(function() {
                    console.log(lis[i].innerHTML);
                },3000)
            })(i);
        }

        //打车案例
        console.log('----------');
        var car = (function() {
            var start = 13;
            var total = 0;
            return {
                price: function(n) {
                    if(n <= 3) {
                        total = start;
                    } else {
                        total = start + (n-3)*5;
                    }
                    return total ;
                },
                yongdu: function(flag) {
                    return flag ? total + 10 : total;
                }
            }
        })();
        console.log(car.price(5));
        console.log(car.yongdu(false));
        console.log(car.yongdu(true));
    </script>
</body>
</html>